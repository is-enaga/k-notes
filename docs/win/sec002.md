---
title: 第2章　WINおよびhypomh関連ファイルのフォーマット 
weight: 20 
---
<!-- ######################################### -->

<!-- =================================== -->
## WINフォーマット
<!-- =================================== -->
{{% callout note %}}

詳しくは以下を参照：
[https://wwweic.eri.u-tokyo.ac.jp/WIN/man.ja/winformat.html](https://wwweic.eri.u-tokyo.ac.jp/WIN/man.ja/winformat.html)

{{% /callout %}}



WINフォーマットはバイナリ列のデータで，
あらかじめ定められた先頭からのByte数を基準に，
どこに何の情報が入っているかが決まっている．

1秒長がデータの1単位で，
1秒長のファイルをLinuxのcatコマンドなどで結合することで，より長い時間長のデータを構成することができる．
<!-- ---------------------------------- -->
### 1秒データ
<!-- ---------------------------------- -->
WINフォーマットは各1秒長データ内で完結している．
具体的には1秒データごとに開始時刻，サンプリングレート，チャンネル名などの最低限の情報が入っている．
<!-- =================================== -->
## 速度構造(stan)ファイル
<!-- =================================== -->
{{% callout note %}}

参考：


- [https://wwweic.eri.u-tokyo.ac.jp/WIN/man.ja/win.html](https://wwweic.eri.u-tokyo.ac.jp/WIN/man.ja/win.html)
- hypomh.f 989行目~



{{% /callout %}}



hypomhの説明ではstanファイルと記されている．
震源決定プログラムhypomhで用いられる速度構造ファイル．

行ごとに内容が定められ，かつ固定長である．
P, Sの速度を個別に指定することはできず，P波速度(Vp [km/s])構造だけを指定する．
深さは0から始まり，km単位で各層の厚さを指定する．

stanファイルについて，震源決定において以下の仕様があることに留意せよ．
{{% callout note %}}
  
震源決定時の仕様:


- S波速度Vsは, Vp/Vs=1.73として扱われる．
- 標高0kmより高い部分のVpは，0kmにおけるVpとする．
- 各層の上端のVpを与え，それらを線形で結んだ速度構造として扱う．
- 「層の数」の上限は20(層の厚さは21個まで, Vpの数は22個まで)．
- 初期震源の時刻の不確かさは入力が必要だが，使われない．
- 直接hypomhを使わずにwinで震源決定するときは，初期震源の緯度と経度は使われない（深さは使われるようだ）．



{{% /callout %}}



ファイルの構成は以下の通り：


- 1行目: 初期震源の位置  
緯度，経度，深さ[km]を各10文字区切りで．
- 2行目: 層の数と名前  
層の数は5文字の整数．2文字のスペースをあけて，3文字の構造名を記す．
- 3行目: 層上端のVp  
各10文字区切り．7つごとに改行する．
- 4行目: 各層の厚さ[km]  
各10文字区切り．7つごとに改行する．


{{< figure   src="https://raw.githubusercontent.com/is-enaga/mynote/main/pygmt/win/stan.png"caption="stanファイルの書式．" >}}
ソースコードでは2行目の名前の後に続けて，
書式「F10.3」の値を二つ読み取っているが，
マニュアルに未記載で何なのかわからない．
サンプルファイルには１つ目に「1」とあるが，2つ目は空白．
要確認．
<!-- =================================== -->
## 震源結果(final)ファイル
<!-- =================================== -->
{{% callout note %}}

参考：


- [https://wwweic.eri.u-tokyo.ac.jp/WIN/man.ja/pickfile.html](https://wwweic.eri.u-tokyo.ac.jp/WIN/man.ja/pickfile.html)
- hypomh.f 289行目~



{{% /callout %}}



hypomhによる震源決定で出力されるfinalファイルのフォーマットについて記す．
winから震源決定を行った場合はpickファイルの「\#f」で始まる行に出力される．

ファイルの構成は以下の通り：


- 1行目: 震源決定の解  
順に発震時刻，緯度，経度，深さ[km]，マグニチュード．
- 2行目: 解の診断と誤差  
順に解についての診断（CONV:収束, NOCN:発散，DEEP:深部．AIRF:遠地）と
発震時刻，緯度，経度，深さ方向それぞれの誤差．  
診断については，CONV以外は正確な結果を期待できない（CONVだからといって「正しい」とも限らないが）．
また発震時刻の誤差は常に0が出力される．
- 3行目: 誤差共分散行列の成分  
順に体格行列の成分Cxx,Cxy,Cxz,Cyy,Cyz,Czz．
Cxx,Cyy,Czzはそれぞれ緯度，経度，深さ方向の誤差の二乗．
震源位置の誤差楕円を描く際に使用．
- 4行目: 計算で用いられた初期震源  
順に緯度，その不確かさ[km]，経度，その不確かさ[km]，深さ，その不確かさ[km]．
- 5行目: 計算に関する他の情報  
順に観測点数，速度構造名，Pピックデータ数，Sピックデータ数，初期データ数．  
ただし，初期データ数は初期震源の座標の数であり，常に3が出力される．
またP, Sそれぞれの寄与率がカッコ内に出力されるが，公式マニュアルによるとそれらの値は信用できないらしい．
- 6行目: 観測点ごとの検測情報  
順に観測点コード，P初動極性，震央距離[km]，観測点方位角，射出角，入射角，
P読み取り時刻[s]，P読み取り精度[s]，PのO-C時間（理論と結果の差）[s]，
S読み取り時刻[s]，S読み取り精度[s]，SのO-C時間（理論と結果の差）[s]，
最大振幅[m/s]またはF-P時間[s]，
マグニチュード．  
F-P時間は最大振幅が読み取られておらず，かつイベント継続時間読まみとられている際に表示される．
そうでないときは最大振幅の値である．  
観測点の数だけ行が続く．
- 7行目: 全観測点をまとめたP,SのO-C  
順にP, SのO-C時間の標準偏差[s]．
<!--  精度よい結果が得られると，各観測点のO-C時間がこれらの値より同程度以下になる． -->


{{< figure   src="https://raw.githubusercontent.com/is-enaga/mynote/main/pygmt/win/final.png" caption="finalファイルの書式．" >}}
<!--  1分データのフォーマットは以下のようになっている． -->

<!--  \begin{table}[H] -->

<!--    \caption{WINフォーマット1秒ブロックの構成} -->

<!--    \centering -->

<!--      \begin{tabular}{lllllll} -->

<!--      \toprule             % --- booktabs: 上の罫線 --- -->

<!--      BBBB& -->

<!--      bbbbbbbb& -->

<!--      BB& -->

<!--      b&bB& -->

<!--      BBBB& -->

<!--      ...   -->

<!--      \midrule -->

<!--      ファイルサイズ& -->

<!--      yymmddHHMMDD& -->

<!--      チャネル番号& -->

<!--      サンプルサイズ& -->

<!--      サンプリングレート& -->

<!--      1サンプル目& -->

<!--      ...   -->

<!--      \bottomrule          % --- booktabs: 底の罫線 --- -->

<!--      \end{tabular} -->

<!--  \end{table} -->

<!--  \begin{table}[H] -->

<!--    \caption{WINフォーマット1秒ブロックの構成} -->

<!--    \centering -->

<!--      \begin{tabular}{lcrrrrrrrc} -->

<!--      \toprule             % --- booktabs: 上の罫線 --- -->

<!--      ヘッダー &  -->

<!--      秒ヘッダー &  -->

<!--      \multicolumn{4}{l}{1チャネル}& -->

<!--      2チャネル& -->

<!--      ...   -->

<!--      \cmidrule(lr){3-6} -->

<!--      & -->

<!--      & -->

<!--      チャネル番号 & サンプルサイズ & サンプリングレート (Hz) & 振幅データ & -->

<!--      & -->

<!--      ...   -->

<!--      \midrule -->

<!--      4& -->

<!--      4& -->

<!--      2 & 0.5 & 1.5 & 可変& -->

<!--      & -->

<!--      ...   -->

<!--      \bottomrule          % --- booktabs: 底の罫線 --- -->

<!--      \end{tabular} -->

<!--  \end{table} -->

<!--  \begin{table}[H] -->

<!--   \caption{SI組立単位} -->

<!--    -->

<!--   \centering -->

<!--    \begin{tabular}{lcrrrrrrrc} -->

<!--     \toprule             % --- booktabs: 上の罫線 --- -->

<!--     物理量 & 単位 & \multicolumn{7}{l}{SI単位系の基本単位} & 他の単位    -->

<!--     \cmidrule(lr){3-9}   % --- booktabs: 3 から 9 列の罫線 --- -->

<!--         & 記号 & m & kg & s & A & K & mol & cd    -->

<!--     \midrule             % --- booktabs: 中間の罫線 --- -->

<!--     力 & N & 1 & 1 & -2 & & & & &    -->

<!--     エネルギー & J & 2 & 1 & -2 & & & & & N{{< math >}} $\cdot$ {{< /math >}}m    -->

<!--     仕事率 & W & 2 & 1 & -3 & & & & & J{{< math >}} $\cdot$ {{< /math >}}s{{< math >}} $^{-1}$ {{< /math >}}    -->

<!--     \addlinespace[5mm]   % --- booktabs: 行間スペース --- -->

<!--     電圧 & V & 2 & 1 & -3 & -1 & & & & W{{< math >}} $\cdot$ {{< /math >}}A{{< math >}} $^{-1}$ {{< /math >}}    -->

<!--     磁束 & Wb & 2 & 1 & -2 & -1 & & & & V{{< math >}} $\cdot$ {{< /math >}}s    -->

<!--     \bottomrule          % --- booktabs: 底の罫線 --- -->

<!--    \end{tabular} -->

<!--  \end{table} -->








